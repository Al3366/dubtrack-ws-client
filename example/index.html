<script src="../bin/client.js"></script>
<script>
var socket = new SocketClient({
  // host: 'wss://dubtrack-websockets-staging.us-east-1.elasticbeanstalk.com',
  host: 'localhost:8081',
  secret: '36ae7a7d6930d146f5a5dbe2c7efc15383509cd1c9cfc9b8'
});

function reattach(channel) {
  channel.attach();OB
  /* Example when using presence on the channel */
  channel.presence.enter();
}

socket.connection.on('connected', () => {
  console.log('channels', socket.channels.all)

  for (let channelName in socket.channels.all) {
    let channel = socket.channels.get(channelName);
    console.log(channel)
    reattach(channel);
  }

  window.channel = socket.channels.get('room:5845fb26b0b5bf0c00fb03cb')
  window.channel2 = socket.channels.get('test2')
  channel.subscribe(console.log)

  channel.presence.get((err, list) => {
    console.log('list', list)
  })
  channel2.subscribe((msg) => {
    console.log('test2', msg)
  })

  channel.presence.on('enter', console.log)
  channel.presence.on('leave', (msg) => {
    console.log('leave', msg)
  })
})

socket.connection.on('disconnected', () => {
  // interval = setInterval(() => {
  //   socket.connection.connect()
  // }, 1000)
})
socket.connection.on('failed', () => console.log('Failed'))
</script>
